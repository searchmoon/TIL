## 배민 우아콘 - 모두의 웹뷰 강의

### 웹뷰의 장점: (웹뷰를 쓰는 이유)

- 하나로 ios,안드, 모바일 브라우저 까지 대응가능,
- 빠른 업데이트,
- 네이티브 기능 사용가능

### 웹뷰의 단점:

- 성능 이슈, 보안 이슈, 사용자 경험

### 알아두면 좋은 웹엔진

- app 은 웹뷰가 왜 이렇게 동작하는지 알 수 있고, FE는 웹스펙의 구현이 이렇구나를 알 수 있다.
- 웹엔진의 종류 두가지: webkit(사파리 등), chromium(크롬 등) 등

사파리에서는 되는데, 크롬에서 안된다. 왤까?

프론트엔드 개발자들은 앱에서 웹을 호출하는 호출 스크립트에서 리턴타입에 Promise 를 사용하는 경우가 있다.

그럴때는 스크립트 실행이 안되고 에러가 발생한다. 그걸 미리 알고있으면 좋다.

웹뷰 동기화 이슈: 앱이 쓰면 - 웹에 동기화 시켜주기. 웹이 쓰면 - 앱에서 가져오기

웹뷰로 할때, 한번 호출되고 마는 함수는 var, let 으로 선언해서 사용하지말고,

즉시실행함수로 실행해주기.

이유는 변수의 스코프를 제한해줘서, 위험성이 적고, 변수 충돌을 회피할 수 있고, 전역변수 관리에 큰 도움이 된다.

```jsx
(function () {
	let age = 18;
})();
```

이런식으로 즉시실행함수 으로 실행.

### 웹 스크립트 호출 개선

![Pasted Graphic 15.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/b08e7419-4fd5-4a8b-9478-184d8f32f525/f0d4bbdb-ad94-43a2-8ebb-58dc5c34da99/Pasted_Graphic_15.png)

try, catch 로 해주면 당장의 에러는 보이지 않지만,

다음 이슈분석이 어렵다.

try catch 로 하지말고, typeof 를 통해 undefined 여부와, null 여부를 확인하고 나서, 함수호출을 해준다.

(try catch 로 했을 시에, catch 부분에서 상세하게 에러 분석을 해놓으면 또 괜찮긴 하다고 한다.)

### Javascript Override

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/b08e7419-4fd5-4a8b-9478-184d8f32f525/915d4485-8941-491e-bc52-f11b41608440/image.png)

history.back 은 웹상에서 back 을 계속하다가, 돌아갈 페이지 가없다면, 내가 지금 보고 있는 페이지를 닫을래. 라는 뜻과 같아서 현재 보고있는 웹뷰를 닫을 수 있는 기능을 이렇게 해줄수도있다. (이렇게도 쓸 수 있구나만 알아놓으면 된다고함)

### 웹뷰 이슈: 

1. 앱스킴이 동작을 안할때:
- 2개를 호출했는데, 1개만 동작할때
    - 앱스킴의 앱 동작에 따라 다를 수 있다.
    - 웹페이지의 호출 코드에 따라 다를 수 있다.
    - 동작하는 한가지가 첫번째 일수도, 두번째 일수도 있다.
    - location.href 를 사용하면 두번째만 수행하게된다.

이를 해결하기 위해 가장 간단한 방법은 앱스킴이 연달아 호출될때, 딜레이를 주는 방법이다.

1. 프론트에서 알 수 없는 오류가 발생할때
- 앱 네이티브와 자바스크립트 문자열 차이
    - 앱에서 웹뷰를 사용할때, 이 세개의 문자열을 조심해야한다.
    → ‘    “    \
    - 이것을 해결하기 위해서는 Encoding 또는 Escaping 하면된다. (Encoding 룰이 다른 경우도 있기 때문에 조심해야한다.)
    - 검색엔진에서는 white space를 + 로 인코딩 하는데, 제공되는 함수에 따라서 + 기호를 인코딩 하지 않는 경우도 있다. 인코딩 룰도 꼭 체크.
1. 웹페이지가 하얗게 나온다.
- IOS에서는 `webViewWebContentProcessDidTerminate(_:)`
구현이 필요하다.
    - 가장 쉬운법: reload()
    - 새로고침 횟수 제한
    - 에러 & 다시시도 UI
- Android 에서는 `onRenderProcessGone()` 구현